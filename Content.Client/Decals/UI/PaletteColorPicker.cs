using System;
using System.Collections.Generic;
using System.Runtime.CompilerServices;
using CompiledRobustXaml;
using Content.Shared.Decals;
using Robust.Client.AutoGenerated;
using Robust.Client.ResourceManagement;
using Robust.Client.UserInterface;
using Robust.Client.UserInterface.Controls;
using Robust.Client.UserInterface.CustomControls;
using Robust.Shared.IoC;
using Robust.Shared.Maths;
using Robust.Shared.Prototypes;

namespace Content.Client.Decals.UI
{
	// Token: 0x0200035E RID: 862
	[GenerateTypedNameReferences]
	public sealed class PaletteColorPicker : DefaultWindow
	{
		// Token: 0x06001562 RID: 5474 RVA: 0x0007DC2C File Offset: 0x0007BE2C
		public PaletteColorPicker()
		{
			PaletteColorPicker.!XamlIlPopulateTrampoline(this);
			IoCManager.InjectDependencies<PaletteColorPicker>(this);
			this._tex = this._resourceCache.GetResource<TextureResource>("/Textures/Interface/Nano/button.svg.96dpi.png", true);
			int num = 0;
			foreach (ColorPalettePrototype colorPalettePrototype in this._prototypeManager.EnumeratePrototypes<ColorPalettePrototype>())
			{
				this.Palettes.AddItem(colorPalettePrototype.Name, null);
				this.Palettes.SetItemMetadata(num, colorPalettePrototype);
				num++;
			}
			this.Palettes.OnItemSelected += delegate(OptionButton.ItemSelectedEventArgs args)
			{
				this.Palettes.SelectId(args.Id);
				this.SetupList();
			};
			this.Palettes.Select(0);
			this.SetupList();
		}

		// Token: 0x06001563 RID: 5475 RVA: 0x0007DCF8 File Offset: 0x0007BEF8
		private void SetupList()
		{
			this.PaletteList.Clear();
			foreach (KeyValuePair<string, Color> keyValuePair in (this.Palettes.SelectedMetadata as ColorPalettePrototype).Colors)
			{
				string text;
				Color color;
				keyValuePair.Deconstruct(out text, out color);
				string text2 = text;
				Color color2 = color;
				ItemList.Item item = this.PaletteList.AddItem(text2, this._tex.Texture, true);
				item.Metadata = color2;
				item.IconModulate = color2;
			}
		}

		// Token: 0x17000454 RID: 1108
		// (get) Token: 0x06001564 RID: 5476 RVA: 0x0007DD9C File Offset: 0x0007BF9C
		public ItemList PaletteList
		{
			get
			{
				return base.FindControl<ItemList>("PaletteList");
			}
		}

		// Token: 0x17000455 RID: 1109
		// (get) Token: 0x06001565 RID: 5477 RVA: 0x0007DDA9 File Offset: 0x0007BFA9
		private OptionButton Palettes
		{
			get
			{
				return base.FindControl<OptionButton>("Palettes");
			}
		}

		// Token: 0x06001567 RID: 5479 RVA: 0x0007DDD0 File Offset: 0x0007BFD0
		static void xaml(IServiceProvider A_0, DefaultWindow A_1)
		{
			XamlIlContext.Context<DefaultWindow> context = new XamlIlContext.Context<DefaultWindow>(A_0, null, "resm:Content.Client.Decals.UI.PaletteColorPicker.xaml?assembly=Content.Client");
			context.RootObject = A_1;
			context.IntermediateRoot = A_1;
			A_1.Title = (string)new LocExtension("palette-color-picker-window-title").ProvideValue();
			A_1.MinSize = new Vector2(250f, 500f);
			A_1.SetSize = new Vector2(250f, 500f);
			BoxContainer boxContainer = new BoxContainer();
			boxContainer.Orientation = 1;
			ItemList itemList = new ItemList();
			itemList.Name = "PaletteList";
			Control control = itemList;
			context.RobustNameScope.Register("PaletteList", control);
			itemList.VerticalExpand = true;
			itemList.Access = new AccessLevel?(0);
			control = itemList;
			boxContainer.XamlChildren.Add(control);
			BoxContainer boxContainer2 = new BoxContainer();
			boxContainer2.Orientation = 0;
			control = new Label
			{
				Text = "Palette"
			};
			boxContainer2.XamlChildren.Add(control);
			OptionButton optionButton = new OptionButton();
			optionButton.Name = "Palettes";
			control = optionButton;
			context.RobustNameScope.Register("Palettes", control);
			control = optionButton;
			boxContainer2.XamlChildren.Add(control);
			control = boxContainer2;
			boxContainer.XamlChildren.Add(control);
			control = boxContainer;
			A_1.XamlChildren.Add(control);
			if ((control = (A_1 as Control)) != null)
			{
				context.RobustNameScope.Absorb(control.NameScope);
				control.NameScope = context.RobustNameScope;
			}
			context.RobustNameScope.Complete();
		}

		// Token: 0x06001568 RID: 5480 RVA: 0x0007DF90 File Offset: 0x0007C190
		private static void !XamlIlPopulateTrampoline(PaletteColorPicker A_0)
		{
			PaletteColorPicker.Populate:Content.Client.Decals.UI.PaletteColorPicker.xaml(null, A_0);
		}

		// Token: 0x04000B1D RID: 2845
		[Nullable(1)]
		[Dependency]
		private readonly IPrototypeManager _prototypeManager;

		// Token: 0x04000B1E RID: 2846
		[Nullable(1)]
		[Dependency]
		private readonly IResourceCache _resourceCache;

		// Token: 0x04000B1F RID: 2847
		[Nullable(1)]
		private readonly TextureResource _tex;
	}
}
